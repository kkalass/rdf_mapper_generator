# RDF Mapper Generator for Dart

[![pub package](https://img.shields.io/pub/v/rdf_mapper_generator.svg)](https://pub.dev/packages/rdf_mapper_generator)
[![build](https://github.com/kkalass/rdf_mapper_generator/actions/workflows/ci.yml/badge.svg)](https://github.com/kkalass/rdf_mapper_generator/actions)
[![codecov](https://codecov.io/gh/kkalass/rdf_mapper_generator/branch/main/graph/badge.svg)](https://codecov.io/gh/kkalass/rdf_mapper_generator)
[![license](https://img.shields.io/github/license/kkalass/rdf_mapper_generator.svg)](https://github.com/kkalass/rdf_mapper_generator/blob/main/LICENSE)

**Transform your Dart classes into RDF mappers with zero boilerplate!** üöÄ

A code generator for creating **type-safe, annotation-driven RDF mappers** in Dart. Simply annotate your classes, run `dart run build_runner build`, and get generated mappers that seamlessly convert between your Dart objects and RDF data.

## ‚ú® Key Features

- **üî• Zero Boilerplate**: Write business logic, not serialization code
- **üõ°Ô∏è Type Safety**: Compile-time guarantees for your RDF mappings  
- **‚ö° Optimized Generation**: Generated code with no runtime overhead
- **üéØ Schema.org Support**: Works with vocabularies from rdf_vocabularies
- **üîß Flexible Mapping**: Custom mappers, IRI templates, and complex relationships
- **üèóÔ∏è Build System Integration**: Seamless integration with build_runner

[üåê **Official Documentation**](https://kkalass.github.io/rdf_mapper_generator/)

## üöÄ Quick Start

### 1. Add Dependencies

```yaml
dependencies:
  rdf_mapper: ^0.8.6
  rdf_mapper_annotations: ^0.2.1
  rdf_vocabularies: ^0.3.0

dev_dependencies:
  build_runner: '>2.5.3'
  rdf_mapper_generator: ^0.2.1
```

### 2. Annotate Your Classes

```dart
import 'package:rdf_mapper_annotations/rdf_mapper_annotations.dart';
import 'package:rdf_vocabularies/schema.dart';

@RdfGlobalResource(
  SchemaBook.classIri,
  IriStrategy('https://example.org/books/{isbn}'),
)
class Book {
  @RdfIriPart()
  final String isbn;

  @RdfProperty(SchemaBook.name)
  final String title;

  @RdfProperty(SchemaBook.author)
  final String author;

  @RdfProperty(SchemaBook.datePublished)
  final DateTime published;

  Book({
    required this.isbn,
    required this.title, 
    required this.author,
    required this.published,
  });
}
```

### 3. Generate Mappers

```bash
dart run build_runner build
```

### 4. Use Your Generated Mappers

```dart
// Initialize the mapper system
final mapper = initRdfMapper();

// Convert Dart object to RDF
final book = Book(
  isbn: '978-0-544-00341-5',
  title: 'The Hobbit',
  author: 'J.R.R. Tolkien',
  published: DateTime(1937, 9, 21),
);

final turtle = mapper.encodeObject(book);
print('Book IRI: ${turtle}');

// Convert RDF back to Dart object
final deserializedBook = mapper.decodeObject<Book>(turtle);
print('Title: ${deserializedBook.title}');
// Output: Title: The Hobbit
```

**That's it!** No manual mapping code, no runtime reflection, just pure generated performance.

## üéØ What Makes This Useful?

### Advanced Features That Work

#### üîó Flexible IRI Generation
```dart
@RdfGlobalResource(
  SchemaBook.classIri,
  IriStrategy('{+baseUrl}/books/{isbn}'),
)
class Book {
  @RdfIriPart()
  final String isbn;
  
  // baseUrl comes from context - useful for configurable deployments, 
  // must be a vaild URL like 'https://library.org/'
}
```

#### üóÇÔ∏è Complex Collections  
```dart
@RdfProperty(SchemaBook.keywords)
final Set<String> keywords;  // Automatic set handling

@RdfProperty(SchemaBook.reviews)
@RdfMapEntry(ReviewEntry)
final Map<String, Review> reviews;  // Custom map entry types
```

#### üè∑Ô∏è Custom Literal Types
```dart
@RdfLiteral()
class Temperature {
  @RdfValue()
  final double celsius;
  
  // Custom serialization with type safety
  LiteralTerm formatCelsius() => LiteralTerm('${celsius}¬∞C');
}
```

#### üîÑ Enum Mapping
```dart
@RdfIri('https://schema.org/BookFormatType/{value}')
enum BookFormat {
  @RdfEnumValue('Hardcover')
  hardcover,
  
  @RdfEnumValue('Paperback') 
  paperback,
  
  @RdfEnumValue('EBook')
  ebook,
}
```

#### üåê Multi-Language Support
```dart
@RdfProperty(
  SchemaBook.description,
  literal: LiteralMapping.withLanguage('en'),
)
final String description;
```

### What Gets Generated (Automatically!)

For each annotated class, you get:
- **Type-safe serialization/deserialization**
- **Optimized IRI pattern matching** with regex
- **Smart default value handling**
- **Collection type inference**
- **Custom mapper integration**
- **Null safety throughout**
- **Performance-optimized code**

## üèóÔ∏è Architecture Overview

### Perfect Integration
Part of a complete **RDF ecosystem for Dart**:

| Package | Purpose | Latest Version |
|---------|---------|----------------|
| [**rdf_core**](https://pub.dev/packages/rdf_core) | Core graph classes, serialization (Turtle, JSON-LD, N-Triples) | ![pub](https://img.shields.io/pub/v/rdf_core.svg) |
| [**rdf_mapper**](https://pub.dev/packages/rdf_mapper) | Runtime mapping system between Dart objects and RDF | ![pub](https://img.shields.io/pub/v/rdf_mapper.svg) |
| [**rdf_mapper_annotations**](https://pub.dev/packages/rdf_mapper_annotations) | Annotation definitions for mapping configuration | ![pub](https://img.shields.io/pub/v/rdf_mapper_annotations.svg) |
| [**rdf_mapper_generator**](https://pub.dev/packages/rdf_mapper_generator) | **This package** - Code generator for mappers | ![pub](https://img.shields.io/pub/v/rdf_mapper_generator.svg) |
| [**rdf_vocabularies**](https://pub.dev/packages/rdf_vocabularies) | Constants for Schema.org, FOAF, Dublin Core, etc. | ![pub](https://img.shields.io/pub/v/rdf_vocabularies.svg) |
| [**rdf_xml**](https://pub.dev/packages/rdf_xml) | RDF/XML format support | ![pub](https://img.shields.io/pub/v/rdf_xml.svg) |

### The Build Process
1. **Scan** your code for RDF annotations
2. **Analyze** types, relationships, and mapping requirements  
3. **Generate** optimized mapper classes with zero runtime overhead
4. **Validate** mappings at compile time
5. **Register** mappers automatically in your initialization code

## üìã Comprehensive Feature Matrix

| Feature | Supported | Example |
|---------|-----------|---------|
| ‚úÖ Global Resources | ‚úì | `@RdfGlobalResource(Schema.Book)` |
| ‚úÖ Local Resources (Blank Nodes) | ‚úì | `@RdfLocalResource(Schema.Chapter)` |
| ‚úÖ IRI Templates | ‚úì | `IriStrategy('https://api.com/{version}/books/{id}')` |
| ‚úÖ Context Variables | ‚úì | `{+baseUri}`, `{category}` |
| ‚úÖ Custom Literal Types | ‚úì | `@RdfLiteral()` with `@RdfValue()` |
| ‚úÖ Enum Mappings | ‚úì | `@RdfIri()` and `@RdfLiteral()` on enums |
| ‚úÖ Collection Types | ‚úì | `List<T>`, `Set<T>`, `Map<K,V>` |
| ‚úÖ Map Entry Resources | ‚úì | `@RdfMapEntry()` with `@RdfMapKey/@RdfMapValue` |
| ‚úÖ Language Tags | ‚úì | `LiteralMapping.withLanguage('en')` |
| ‚úÖ Custom Datatypes | ‚úì | `LiteralMapping(datatype: XSD.dateTime)` |
| ‚úÖ Default Values | ‚úì | `@RdfProperty(predicate, defaultValue: 'default')` |
| ‚úÖ Optional Properties | ‚úì | Nullable types with smart handling |
| ‚úÖ Named Mappers | ‚úì | `LiteralMapping.namedMapper('myMapper')` |
| ‚úÖ Mapper Instances | ‚úì | `LiteralMapping.mapperInstance(MyMapper())` |
| ‚úÖ Provider Functions | ‚úì | Dynamic context through provider functions |
| ‚úÖ Null Safety | ‚úì | Full null safety throughout |

## üìñ Complete Examples

### E-commerce Product Catalog
```dart
@RdfGlobalResource(
  SchemaProduct.classIri,
  IriStrategy('https://store.example.com/products/{sku}'),
)
class Product {
  @RdfIriPart()
  final String sku;

  @RdfProperty(SchemaProduct.name)
  final String name;

  @RdfProperty(SchemaProduct.offers)
  final List<Offer> offers;

  @RdfProperty(SchemaProduct.brand)
  final Brand brand;

  @RdfProperty(SchemaProduct.aggregateRating)
  final AggregateRating? rating;

  Product({...});
}

@RdfLocalResource(SchemaOffer.classIri)
class Offer {
  @RdfProperty(SchemaOffer.price)
  final double price;

  @RdfProperty(SchemaOffer.priceCurrency)
  final Currency currency;

  @RdfProperty(SchemaOffer.availability)
  final ProductAvailability availability;
}

@RdfIri('https://schema.org/ItemAvailability/{value}')
enum ProductAvailability {
  @RdfEnumValue('InStock')
  inStock,
  
  @RdfEnumValue('OutOfStock') 
  outOfStock,
  
  @RdfEnumValue('PreOrder')
  preOrder,
}
```

### Scientific Data with Custom Types
```dart
@RdfLiteral(datatype: 'https://units.org/Temperature')
class Temperature {
  @RdfValue()
  final double celsius;

  LiteralTerm formatCelsius() => 
    LiteralTerm('${celsius}¬∞C', datatype: IriTerm('https://units.org/Temperature'));
    
  static Temperature parse(LiteralTerm term) => 
    Temperature(double.parse(term.value.replaceAll('¬∞C', '')));
}

@RdfGlobalResource(
  'https://science.org/Measurement',
  IriStrategy('https://lab.org/measurements/{id}'),
)
class Measurement {
  @RdfIriPart()
  final String id;

  @RdfProperty('https://science.org/temperature')
  final Temperature temperature;

  @RdfProperty('https://science.org/timestamp')
  final DateTime timestamp;

  @RdfProperty(
    'https://science.org/location',
    iri: IriMapping('https://geo.org/{latitude},{longitude}'),
  )
  final String coordinates;
}
```


## ÔøΩ Advanced Configuration

### Build Configuration (`build.yaml`)
```yaml
targets:
  $default:
    builders:
      rdf_mapper_generator:rdf_mapper_generator:
        generate_for:
          - lib/**.dart
        options:
          # Generator options
```

### Context Providers for Dynamic Mapping
```dart
final mapper = initRdfMapper(
  // Dynamic base URIs for multi-tenant applications
  baseUriProvider: () => getCurrentTenant().baseUri,
  
  // API versioning
  versionProvider: () => 'v2',
  
  // User-specific contexts
  userIdProvider: () => getCurrentUser().id,
);
```

## üöÄ Performance & Production Ready

### Why This Approach Works
- **Zero runtime overhead**: All mapping logic generated at compile time
- **Tree-shakeable**: Only used mappers included in final build  
- **Type-safe**: Compile-time validation of all mappings
- **Optimized patterns**: Smart regex generation for IRI parsing
- **Null safety**: Full null safety with smart default handling

## üéì Learning Resources

### üéØ Real Examples
- [**Full Book Example**](test/fixtures/rdf_mapper_annotations/examples/example_full_book.dart) - Complete Schema.org Book with chapters
- [**CRDT Item Example**](test/fixtures/rdf_mapper_annotations/examples/example_crdt_item.dart) - Distributed systems with vector clocks  
- [**Enum Mapping Examples**](test/fixtures/rdf_mapper_annotations/examples/enum_mapping_simple.dart) - All enum mapping patterns
- [**IRI Strategy Examples**](test/fixtures/rdf_mapper_annotations/examples/example_iri_strategies.dart) - Dynamic IRI generation

### üß™ Try It
```bash
# Clone and explore examples
git clone https://github.com/kkalass/rdf_mapper_generator.git
cd rdf_mapper_generator
dart pub get
dart run build_runner build

# Run comprehensive tests
dart test

# Explore the generated mappers
find test/fixtures/rdf_mapper_annotations/examples -name "*.rdf_mapper.g.dart"
# Look at specific generated files:
# - test/fixtures/rdf_mapper_annotations/examples/provides.rdf_mapper.g.dart
# - test/fixtures/rdf_mapper_annotations/examples/example_full_book.rdf_mapper.g.dart  
# - test/fixtures/rdf_mapper_annotations/examples/enum_mapping_simple.rdf_mapper.g.dart
```

## üõ£Ô∏è Roadmap & Evolution

### Current: v0.2.1 ‚úÖ
- ‚úÖ Full annotation support (global/local resources, literals, IRIs)
- ‚úÖ Complex IRI templates with context variables
- ‚úÖ Custom mapper integration (named, by type, by instance)
- ‚úÖ Collection support (List, Set, Map with custom entry types)
- ‚úÖ Enum mappings (both IRI and literal)
- ‚úÖ Language tag support
- ‚úÖ Comprehensive test coverage
- ‚úÖ Null safety throughout

### Next: v0.3.0 üéØ
- üîÑ Enhanced validation with helpful error messages
- üîÑ Documentation improvements

### Future: v1.0.0 üåü
- üåü Stable API guarantee
- üåü Advanced inheritance support

## ü§ù Contributing

**We'd love your help making this even better!**

### Get Started
```bash
git clone https://github.com/kkalass/rdf_mapper_generator.git
cd rdf_mapper_generator
dart pub get
dart test
```

### Ways to Contribute
- üêõ **Bug Reports**: Found an issue? [Open an issue](https://github.com/kkalass/rdf_mapper_generator/issues)
- üí° **Feature Requests**: Have ideas? [Start a discussion](https://github.com/kkalass/rdf_mapper_generator/discussions)
- üìù **Documentation**: Help improve our docs
- üß™ **Examples**: Add real-world usage examples
- ‚ö° **Performance**: Help optimize generated code
- üîß **Testing**: Expand our test coverage

### Guidelines
- See [CONTRIBUTING.md](CONTRIBUTING.md) for detailed guidelines
- Follow Dart conventions and best practices
- Add tests for new features
- Update documentation for API changes

## üèÜ Project Status

### Development Milestones
- **First functional release**: Successfully generating working mappers
- **Test applications**: Used in experimental projects for validation
- **Growing feature set**: Continuous addition of mapping capabilities

### Community Impact
- **Zero-boilerplate RDF**: Novel approach in Dart ecosystem
- **Type-safe mapping**: Advancing RDF tooling standards  
- **Open development**: Transparent development process
- **Real-world validation**: Tested with actual use cases


## ü§ñ AI Policy

This project combines **human expertise with AI assistance**:

- **Human-led**: All architectural decisions, code reviews, and design choices made by humans
- **AI-enhanced**: Leveraging LLMs for code generation, documentation, and testing
- **Quality-focused**: AI helps iterate faster while maintaining high standards
- **Innovation-driven**: Using available tools to build better software

*The future of development is human creativity enhanced by AI capabilities.*

---


## üìÑ License

MIT License - see [LICENSE](LICENSE) file for details.

**¬© 2025 Klas Kala√ü** - Built with ‚ù§Ô∏è for the Dart & RDF communities.

---

‚≠ê **Star this repo** if it helped you build something awesome!

[**üåê Documentation**](https://kkalass.github.io/rdf_mapper_generator/) ‚Ä¢ [**üì¶ pub.dev**](https://pub.dev/packages/rdf_mapper_generator) ‚Ä¢ [**üêõ Issues**](https://github.com/kkalass/rdf_mapper_generator/issues) 
